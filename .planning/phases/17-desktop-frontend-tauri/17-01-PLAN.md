---
phase: 17-desktop-frontend-tauri
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/desktop/package.json
  - apps/desktop/tsconfig.json
  - apps/desktop/vite.config.ts
  - apps/desktop/index.html
  - apps/desktop/src/main.tsx
  - apps/desktop/src/App.tsx
  - apps/desktop/src/index.css
  - apps/desktop/src/pages/DashboardPage.tsx
  - apps/desktop/src/pages/ChatPage.tsx
  - apps/desktop/src/pages/AgentsPage.tsx
  - apps/desktop/src/pages/SettingsPage.tsx
  - apps/desktop/src/components/Sidebar.tsx
  - apps/desktop/src/components/Layout.tsx
  - apps/desktop/src-tauri/Cargo.toml
  - apps/desktop/src-tauri/tauri.conf.json
  - apps/desktop/src-tauri/capabilities/default.json
  - apps/desktop/src-tauri/src/lib.rs
  - apps/desktop/src-tauri/src/main.rs
autonomous: true
requirements:
  - DESK-01

must_haves:
  truths:
    - "Tauri desktop app launches and shows a window with a React-rendered page"
    - "Vite dev server serves the React frontend during development"
    - "Tauri plugins (websocket, shell, fs, process) are registered and accessible from JS"
  artifacts:
    - path: "apps/desktop/package.json"
      provides: "Workspace package definition with Tauri + React + Vite deps"
    - path: "apps/desktop/src-tauri/tauri.conf.json"
      provides: "Tauri configuration with window settings, CSP, and build commands"
    - path: "apps/desktop/src-tauri/src/lib.rs"
      provides: "Rust entry point with all plugin registrations"
    - path: "apps/desktop/src/App.tsx"
      provides: "Root React component with navigation shell"
  key_links:
    - from: "apps/desktop/src-tauri/tauri.conf.json"
      to: "apps/desktop/src/main.tsx"
      via: "devUrl pointing to Vite dev server at localhost:5173"
      pattern: "devUrl.*localhost:5173"
    - from: "apps/desktop/src-tauri/src/lib.rs"
      to: "apps/desktop/src-tauri/Cargo.toml"
      via: "Plugin crate imports"
      pattern: "tauri_plugin_websocket"
---

<objective>
Scaffold the Tauri v2 desktop app with React + Vite frontend and Rust backend, including all required plugin registrations, a navigation shell with sidebar, and Tailwind CSS styling.

Purpose: Establish the foundational desktop app structure that all subsequent plans build upon.
Output: A working Tauri app at apps/desktop that opens a window with a multi-page navigation shell.
</objective>

<execution_context>
@/Users/hitekmedia/.claude/get-shit-done/workflows/execute-plan.md
@/Users/hitekmedia/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/17-desktop-frontend-tauri/17-RESEARCH.md
@pnpm-workspace.yaml
@packages/core/src/config/constants.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Tauri app scaffold with Rust backend and plugin registrations</name>
  <files>
    apps/desktop/package.json
    apps/desktop/tsconfig.json
    apps/desktop/vite.config.ts
    apps/desktop/index.html
    apps/desktop/src-tauri/Cargo.toml
    apps/desktop/src-tauri/tauri.conf.json
    apps/desktop/src-tauri/capabilities/default.json
    apps/desktop/src-tauri/src/lib.rs
    apps/desktop/src-tauri/src/main.rs
  </files>
  <action>
    Create the `apps/desktop/` directory structure for a Tauri v2 app.

    **package.json:** Name `@tek/desktop`, type `module`. Dependencies: `react`, `react-dom`, `@tauri-apps/api@^2.10`, `@tauri-apps/plugin-websocket@^2`, `@tauri-apps/plugin-shell@^2`, `@tauri-apps/plugin-fs@^2`, `@tauri-apps/plugin-process@^2`, `zustand@^5`, `@tek/core` (workspace:*), `@tek/gateway` (workspace:*). DevDependencies: `@tauri-apps/cli@^2.10`, `@types/react`, `@types/react-dom`, `vite@^6`, `@vitejs/plugin-react`, `typescript@^5.9`, `tailwindcss@^4`, `@tailwindcss/vite`. Scripts: `"dev": "vite"`, `"build": "vite build"`, `"tauri": "tauri"`.

    **tsconfig.json:** Target ESNext, module ESNext, moduleResolution Bundler, jsx react-jsx, strict true. Include `src/**/*.ts`, `src/**/*.tsx`.

    **vite.config.ts:** Use the exact config from research: `@vitejs/plugin-react` plugin, `@tailwindcss/vite` plugin, clearScreen false, port 5173 with strictPort true, watch ignore `**/src-tauri/**`, build target safari13 (macOS).

    **index.html:** Standard Vite React template with `<div id="root">` and `<script type="module" src="/src/main.tsx">`.

    **src-tauri/Cargo.toml:** Package name `tek-desktop`, edition 2021. Dependencies: `tauri` with features `["tray-icon"]`, `tauri-plugin-websocket`, `tauri-plugin-shell` with features `["open"]`, `tauri-plugin-fs`, `tauri-plugin-process`, `serde` with `derive`, `serde_json`.

    **src-tauri/tauri.conf.json:** Use config from research with productName "Tek", identifier "com.tek.desktop", devUrl "http://localhost:5173", frontendDist "../dist", window 1000x700 min 600x400. CSP: `"default-src 'self'; connect-src 'self' ws://127.0.0.1:*; style-src 'self' 'unsafe-inline'"`. Bundle targets: `["dmg", "app"]`.

    **src-tauri/capabilities/default.json:** Use capabilities from research: core:default, websocket:default, shell:allow-execute, shell:allow-spawn, fs:allow-read-text-file, fs:allow-write-text-file, fs:allow-exists, fs:scope for $HOME/.config/tek/** and $HOME/tek/**, shell:allow-execute for tek command, process:default.

    **src-tauri/src/lib.rs:** Register all 4 plugins (websocket, shell, fs, process) using the pattern from research. Add `#[cfg_attr(mobile, tauri::mobile_entry_point)]`.

    **src-tauri/src/main.rs:** Standard `fn main() { tek_desktop::run(); }` with windows_subsystem attribute.

    Do NOT run `tauri add` -- install plugins manually per research guidance (pnpm workspace detection bug).
  </action>
  <verify>
    - `cd apps/desktop && pnpm install` succeeds
    - `cd apps/desktop/src-tauri && cargo check` compiles without errors
    - `cat apps/desktop/src-tauri/src/lib.rs` shows all 4 plugin registrations
  </verify>
  <done>Tauri Rust backend compiles with all 4 plugins registered, JS dependencies installed</done>
</task>

<task type="auto">
  <name>Task 2: Create React frontend with navigation shell and Tailwind CSS</name>
  <files>
    apps/desktop/src/main.tsx
    apps/desktop/src/App.tsx
    apps/desktop/src/index.css
    apps/desktop/src/pages/DashboardPage.tsx
    apps/desktop/src/pages/ChatPage.tsx
    apps/desktop/src/pages/AgentsPage.tsx
    apps/desktop/src/pages/SettingsPage.tsx
    apps/desktop/src/components/Sidebar.tsx
    apps/desktop/src/components/Layout.tsx
  </files>
  <action>
    Create the React frontend with a navigation shell.

    **src/index.css:** Import Tailwind v4: `@import "tailwindcss";`. Set base styles: dark background (#0f0f0f), light text (#e0e0e0), font-family system-ui.

    **src/main.tsx:** Standard React 19 createRoot rendering `<App />` into `#root`.

    **src/App.tsx:** Simple hash-based routing (no react-router needed for 4 pages). Use `useState` for current page, render `<Layout>` wrapping the active page component. Default to DashboardPage. Pages: dashboard, chat, agents, settings.

    **src/components/Layout.tsx:** Flex layout with Sidebar (w-56, fixed left) and main content area. Full viewport height.

    **src/components/Sidebar.tsx:** Navigation sidebar with: app title "Tek" at top, nav links for Dashboard (home icon), Chat (message icon), Agents (users icon), Settings (gear icon). Use simple SVG icons or unicode characters. Active page highlighted with accent color (blue-500). Sidebar has dark bg (#1a1a1a) with border-right.

    **Page stubs (DashboardPage, ChatPage, AgentsPage, SettingsPage):** Each exports a React component with a heading and brief placeholder text. Example: `<div className="p-6"><h1 className="text-2xl font-bold">Dashboard</h1><p className="text-gray-400 mt-2">Gateway status and controls will appear here.</p></div>`.

    Keep pages as stubs -- they will be implemented in subsequent plans.
  </action>
  <verify>
    - `cd apps/desktop && pnpm dev` starts Vite dev server on port 5173
    - `cd apps/desktop && pnpm tauri dev` opens a Tauri window showing the navigation shell (if Rust compiles; may need `pnpm install` first)
    - All 4 navigation links render and switch pages
  </verify>
  <done>React frontend renders a navigation shell with sidebar, 4 page stubs, and Tailwind styling inside a Tauri window</done>
</task>

</tasks>

<verification>
- `pnpm install` at workspace root recognizes apps/desktop
- `cd apps/desktop/src-tauri && cargo check` passes
- `cd apps/desktop && pnpm tauri dev` opens a native window with the React app
- Navigation between all 4 pages works
- Tailwind CSS classes apply correctly (dark background, styled sidebar)
</verification>

<success_criteria>
A native macOS desktop window opens via `pnpm tauri dev` showing a React app with sidebar navigation between Dashboard, Chat, Agents, and Settings pages. All Tauri plugins (websocket, shell, fs, process) are registered and available.
</success_criteria>

<output>
After completion, create `.planning/phases/17-desktop-frontend-tauri/17-01-SUMMARY.md`
</output>
