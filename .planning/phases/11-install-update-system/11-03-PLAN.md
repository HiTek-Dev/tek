---
phase: 11-install-update-system
plan: 03
type: execute
wave: 2
depends_on: ["11-01"]
files_modified:
  - scripts/reset.sh
autonomous: true

must_haves:
  truths:
    - "User can run reset.sh to wipe all user data and return to a clean state"
    - "Reset requires explicit confirmation (typing RESET) to prevent accidental data loss"
    - "Gateway is stopped before wiping data"
    - "Reset script tells user how to re-initialize after wipe"
  artifacts:
    - path: "scripts/reset.sh"
      provides: "Fresh-start reset script that wipes user data"
      contains: "RESET"
  key_links:
    - from: "scripts/reset.sh"
      to: "~/.config/agentspace/"
      via: "rm -rf to wipe config directory"
      pattern: "rm.*config/agentspace"
---

<objective>
Create reset.sh that wipes all AgentSpace user data (config, database, memory) for a fresh start. The script requires explicit confirmation, stops the gateway if running, removes `~/.config/agentspace/`, and prints instructions for re-initialization. It does NOT touch the installed code.

Purpose: Enable users to start fresh without reinstalling, supporting rapid develop-test-update cycles
Output: One executable shell script in `scripts/` directory
</objective>

<execution_context>
@/Users/hitekmedia/.claude/get-shit-done/workflows/execute-plan.md
@/Users/hitekmedia/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-install-update-system/11-RESEARCH.md
@packages/core/src/config/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create reset.sh script</name>
  <files>scripts/reset.sh</files>
  <action>
Create `scripts/reset.sh` with `#!/usr/bin/env bash` and `set -euo pipefail`.

**No arguments required** (operates on `~/.config/agentspace/` always).

**Steps the script performs:**
1. Set `CONFIG_DIR="$HOME/.config/agentspace"` and `RUNTIME="$CONFIG_DIR/runtime.json"`
2. Print warning listing what will be deleted:
   ```
   echo "WARNING: This will delete ALL AgentSpace user data:"
   echo "  - Configuration ($CONFIG_DIR/config.json)"
   echo "  - Database ($CONFIG_DIR/agentspace.db)"
   echo "  - Memory files ($CONFIG_DIR/memory/)"
   echo "  - Runtime state ($CONFIG_DIR/runtime.json)"
   echo ""
   ```
3. Prompt for confirmation: `read -p "Type 'RESET' to confirm: " confirm`
4. Abort if not confirmed: `[ "$confirm" != "RESET" ] && echo "Cancelled." && exit 0`
5. Stop gateway if running (same pattern as update.sh):
   ```
   if [ -f "$RUNTIME" ]; then
     PID=$(node -e "console.log(JSON.parse(require('fs').readFileSync('$RUNTIME','utf-8')).pid)" 2>/dev/null || echo "")
     if [ -n "$PID" ] && kill -0 "$PID" 2>/dev/null; then
       echo "Stopping gateway (PID $PID)..."
       kill "$PID"
       sleep 2
     fi
   fi
   ```
6. Remove entire config directory: `rm -rf "$CONFIG_DIR"`
7. Print post-reset instructions:
   ```
   echo ""
   echo "All user data removed."
   echo ""
   echo "Note: Keychain credentials (API keys) are stored separately in the OS keychain."
   echo "To remove them, run: agentspace keys remove <provider>"
   echo ""
   echo "To set up AgentSpace from scratch, run: agentspace init"
   ```

Mark the file executable: `chmod +x scripts/reset.sh`

Design decisions:
- Does NOT delete keychain entries (API keys are stored in macOS Keychain via @napi-rs/keyring, not filesystem). Prints instructions for manual removal.
- Does NOT delete the install directory (that's not user data, that's code).
- Exits with 0 even on cancellation (not an error).
  </action>
  <verify>
Run `bash -n scripts/reset.sh` to syntax-check. Verify the script is executable. Read through and confirm: confirmation prompt exists, gateway stop logic is present, rm -rf targets only `~/.config/agentspace/`, and post-reset instructions mention keychain and `agentspace init`.
  </verify>
  <done>reset.sh prompts for RESET confirmation, stops the gateway, wipes ~/.config/agentspace/, and prints re-initialization instructions. Code installation is untouched.</done>
</task>

</tasks>

<verification>
1. `bash -n scripts/reset.sh` passes syntax check
2. Script is executable (`-x` permission)
3. Confirmation prompt requires exact string "RESET"
4. Script stops gateway before deleting files
5. Only `~/.config/agentspace/` is deleted (not install directory, not keychain)
6. Post-reset message tells user how to re-initialize
</verification>

<success_criteria>
A user can run `scripts/reset.sh` to completely wipe their AgentSpace user data and start fresh. The script is safe (requires explicit confirmation) and informative (tells user what was removed and how to re-initialize).
</success_criteria>

<output>
After completion, create `.planning/phases/11-install-update-system/11-03-SUMMARY.md`
</output>
