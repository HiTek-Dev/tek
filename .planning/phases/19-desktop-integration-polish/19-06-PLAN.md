---
phase: 19-desktop-integration-polish
plan: 06
type: execute
wave: 3
depends_on: ["19-01", "19-02", "19-03", "19-04", "19-05"]
files_modified: []
autonomous: false
requirements: []

must_haves:
  truths:
    - "Full install -> init -> agent setup -> chat -> uninstall cycle works end-to-end"
    - "tek gateway stop reliably stops the gateway"
    - "Chat responds with agent personality context after init"
    - "Settings page renders without crashes"
    - "Agents page shows agents and allows creation"
    - "Desktop UI has consistent icons and spacing"
    - "Telegram bot starts if configured"
  artifacts: []
  key_links: []
---

<objective>
End-to-end verification of all phase 19 fixes.

Purpose: After all bug fixes and UI polish from plans 01-05, verify the complete user flow works end-to-end: install, init, agent setup, chat with personality, gateway lifecycle, and uninstall. This is the final quality gate.

Output: Verified end-to-end flow or list of remaining issues.
</objective>

<execution_context>
@/Users/hitekmedia/.claude/get-shit-done/workflows/execute-plan.md
@/Users/hitekmedia/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-desktop-integration-polish/19-01-SUMMARY.md
@.planning/phases/19-desktop-integration-polish/19-02-SUMMARY.md
@.planning/phases/19-desktop-integration-polish/19-03-SUMMARY.md
@.planning/phases/19-desktop-integration-polish/19-04-SUMMARY.md
@.planning/phases/19-desktop-integration-polish/19-05-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 1: End-to-end verification of all phase 19 fixes</name>
  <what-built>
All phase 19 bug fixes and polish:
- Gateway graceful shutdown (server.close before exit)
- Desktop stale gateway detection (HTTP health check)
- Init writes identity to USER.md and SOUL.md
- Settings page config normalization (array/record modelAliases)
- Agents page redesign (list + create + per-agent editing)
- Agent workspace isolation (accessMode, per-agent directories)
- Desktop UI polish (SVG icons, consistent spacing, chat styling)
- Telegram bot punycode fix and gateway auto-start
  </what-built>
  <how-to-verify>
**1. Gateway Lifecycle:**
- Run `tek gateway start` — verify it starts
- Run `tek gateway stop` — verify it stops reliably
- Run `tek gateway start` again — verify no EADDRINUSE error
- Kill the gateway process manually (kill -9), then run `tek gateway stop` — verify it handles the stale state

**2. Init Identity Files:**
- Run `tek init` and set a user name and agent name
- Check `~/.config/tek/memory/USER.md` — should contain the user name
- Check `~/.config/tek/memory/SOUL.md` — should contain the agent name

**3. Chat with Personality:**
- Start gateway, open a chat session (CLI or desktop)
- Ask "What is your name?" — agent should respond with its configured name
- Ask "What is my name?" — agent should respond with the user's name from init

**4. Desktop Settings:**
- Open desktop app, navigate to Settings
- Verify it loads without crash
- Verify model aliases display correctly
- Try adding and removing an alias, save

**5. Desktop Agents:**
- Navigate to Agents page
- Verify agent list shows (at least "default" agent)
- Click "Create Agent" and fill in name/description/access mode
- Verify agent directory is created at `~/.config/tek/agents/{id}/`
- Select the new agent, verify identity file editor loads
- Edit a file and save

**6. Desktop UI Polish:**
- Check sidebar — icons should be SVGs (no garbled Unicode)
- Check dashboard — action card icons should be SVGs
- Check chat page — messages should have spacing and visual distinction
- Check overall spacing consistency across pages

**7. Telegram (if configured):**
- Verify no punycode error in gateway logs
- Send a message to the Telegram bot — verify it responds
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe any remaining issues</resume-signal>
</task>

</tasks>

<verification>
All 8 success criteria from the phase roadmap verified:
1. tek gateway stop reliably stops
2. Chat loads agent identity files
3. Settings page renders without crash
4. Agents page shows agents with create flow
5. Agent workspace isolation works
6. Desktop UI has consistent polish
7. Telegram bot starts
8. End-to-end flow works
</verification>

<success_criteria>
- All 7 verification steps pass
- No crashes or errors during the full flow
- Agent personality is reflected in chat responses
- Desktop app is visually polished and consistent
</success_criteria>

<output>
After completion, create `.planning/phases/19-desktop-integration-polish/19-06-SUMMARY.md`
</output>
