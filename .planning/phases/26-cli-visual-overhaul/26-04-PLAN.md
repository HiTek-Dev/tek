---
phase: 26-cli-visual-overhaul
plan: 04
type: execute
wave: 2
depends_on: ["26-02", "26-03"]
files_modified:
  - packages/cli/src/components/WelcomeScreen.tsx
  - packages/cli/src/components/StatusBar.tsx
  - packages/cli/src/components/Chat.tsx
autonomous: true
requirements:
  - CLIV-05
  - CLIV-08

must_haves:
  truths:
    - "Empty chat shows welcome screen with agent name, slash commands, and keyboard shortcuts"
    - "StatusBar displays a single-line multi-zone layout with connection status, model/provider, and token count + cost"
    - "Welcome screen disappears once the first message is sent or streaming begins"
    - "Active tool calls render in the live region with expand/collapse capability via ToolPanel"
  artifacts:
    - path: "packages/cli/src/components/WelcomeScreen.tsx"
      provides: "Empty state welcome screen"
      exports: ["WelcomeScreen"]
    - path: "packages/cli/src/components/StatusBar.tsx"
      provides: "Redesigned multi-zone status bar"
      exports: ["StatusBar"]
    - path: "packages/cli/src/components/Chat.tsx"
      provides: "Orchestrator with welcome screen and live tool panel wiring"
      contains: "WelcomeScreen"
  key_links:
    - from: "packages/cli/src/components/Chat.tsx"
      to: "packages/cli/src/components/WelcomeScreen.tsx"
      via: "conditional render when messages.length === 0"
      pattern: "messages\\.length.*===.*0"
    - from: "packages/cli/src/components/Chat.tsx"
      to: "packages/cli/src/components/ToolPanel.tsx"
      via: "renders active tool call in live region"
      pattern: "ToolPanel"
---

<objective>
Add welcome screen for empty chat state, redesign StatusBar with compact multi-zone layout, and wire ToolPanel into Chat.tsx's live render region for active tool call interactivity.

Purpose: New users see a blank screen with no guidance. The StatusBar wastes vertical space with a border. Active tool calls should be expandable in the live render region while historical ones stay collapsed in Static.

Output: New `WelcomeScreen.tsx`, redesigned `StatusBar.tsx`, updated `Chat.tsx` with welcome screen conditional and live ToolPanel.
</objective>

<execution_context>
@/Users/hitekmedia/.claude/get-shit-done/workflows/execute-plan.md
@/Users/hitekmedia/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/26-cli-visual-overhaul/26-RESEARCH.md
@.planning/phases/26-cli-visual-overhaul/26-02-SUMMARY.md
@.planning/phases/26-cli-visual-overhaul/26-03-SUMMARY.md
@packages/cli/src/components/Chat.tsx
@packages/cli/src/components/StatusBar.tsx
@packages/cli/src/hooks/useSlashCommands.ts
@packages/cli/src/hooks/useChat.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create WelcomeScreen and redesign StatusBar</name>
  <files>
    packages/cli/src/components/WelcomeScreen.tsx
    packages/cli/src/components/StatusBar.tsx
  </files>
  <action>
1. Create `packages/cli/src/components/WelcomeScreen.tsx`:
   - Import `Box`, `Text` from `ink`, `DISPLAY_NAME` from `@tek/core`
   - Props: none (or optional `{ agentName?: string }` if agent name is available)
   - Render a centered welcome panel:
     ```
     <Box flexDirection="column" padding={1}>
       <Text bold color="cyan">{DISPLAY_NAME}</Text>
       <Text dimColor>Type a message to start chatting, or use a command:</Text>
       <Text>{''}</Text>
       <Text>  /help     Show all commands</Text>
       <Text>  /model    Switch model</Text>
       <Text>  /swap     Switch by alias</Text>
       <Text>  /proxy    Run terminal app</Text>
       <Text>{''}</Text>
       <Text dimColor>Enter to send · Shift+Enter for newline · ↑/↓ for history</Text>
     </Box>
     ```
   - Keep it simple and static — no state needed

2. Redesign `packages/cli/src/components/StatusBar.tsx`:
   - Remove the `borderStyle="single"` and `borderColor="gray"` from the outer Box — saves 2 vertical lines
   - Remove `paddingX={1}` (border provided the padding)
   - Keep `justifyContent="space-between"` on the outer Box
   - Three zones in a single line:
     - **Zone 1 (left):** Connection dot + display name
       `<Box><Text color={connected ? 'green' : 'red'}>● </Text><Text bold>{DISPLAY_NAME}</Text></Box>`
     - **Zone 2 (center):** Model name (already shortened)
       `<Text color="cyan">{shortModel}</Text>`
     - **Zone 3 (right):** Token count + cost in compact format
       `<Text dimColor>{usage.totalTokens.toLocaleString()} tok · ${usage.totalCost.toFixed(2)}</Text>`
   - Remove `sessionDisplay` from the status bar (session ID is not useful to display — it was taking up space). If we want to preserve session info, it can go in `/session` command output.
   - Result: a clean single-line status bar with no border, no wasted vertical space
  </action>
  <verify>
    - `packages/cli/src/components/WelcomeScreen.tsx` exists and exports `WelcomeScreen`
    - `grep "borderStyle" packages/cli/src/components/StatusBar.tsx` returns empty (border removed)
    - `grep "DISPLAY_NAME" packages/cli/src/components/WelcomeScreen.tsx` returns a match
    - `pnpm --filter @tek/cli build` succeeds
  </verify>
  <done>
    - WelcomeScreen shows agent name, slash commands, and keyboard shortcuts
    - StatusBar is a compact single-line layout with 3 zones (no border, no session ID)
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire WelcomeScreen and live ToolPanel into Chat.tsx</name>
  <files>packages/cli/src/components/Chat.tsx</files>
  <action>
1. Add imports to Chat.tsx:
   - `import { WelcomeScreen } from './WelcomeScreen.js'`
   - `import { ToolPanel } from './ToolPanel.js'`

2. Add welcome screen conditional:
   - Between StatusBar and MessageList, add:
     ```tsx
     {messages.length === 0 && !isStreaming && <WelcomeScreen />}
     ```
   - When messages exist OR streaming is active, the welcome screen disappears

3. Wire active tool call into live ToolPanel:
   - From `useChat`, `toolCalls` is already returned (array of tool call tracking objects with `toolCallId`, `toolName`, `args`, `result`, `status`)
   - After `MessageList` and before the approval/input section, render the most recent pending tool call using ToolPanel:
     ```tsx
     {/* Active tool call in live region — expandable */}
     {toolCalls.length > 0 && toolCalls[toolCalls.length - 1].status === 'pending' && (
       <ToolPanel
         toolName={toolCalls[toolCalls.length - 1].toolName}
         status={toolCalls[toolCalls.length - 1].status}
         input={typeof toolCalls[toolCalls.length - 1].args === 'string'
           ? toolCalls[toolCalls.length - 1].args as string
           : JSON.stringify(toolCalls[toolCalls.length - 1].args, null, 2)}
         isFocused={!isStreaming && !pendingApproval && !pendingPreflight}
       />
     )}
     ```
   - This renders the active/pending tool call in the live region where useState/useInput work correctly
   - Once the tool call completes (status changes from 'pending'), it disappears from the live region — the completed version is already in the Static message list via MessageBubble

4. Destructure `toolCalls` from useChat return if not already destructured in Chat.tsx

5. Verify the build: `pnpm --filter @tek/cli build`
  </action>
  <verify>
    - `grep "WelcomeScreen" packages/cli/src/components/Chat.tsx` returns import and usage
    - `grep "ToolPanel" packages/cli/src/components/Chat.tsx` returns import and usage
    - `grep "messages.length === 0" packages/cli/src/components/Chat.tsx` returns welcome condition
    - `pnpm --filter @tek/cli build` succeeds
  </verify>
  <done>
    - Empty chat shows WelcomeScreen, disappears when first message sent
    - Active (pending) tool call renders in live region via ToolPanel with expand/collapse
    - Completed tool calls remain as collapsed summaries in Static (via MessageBubble)
    - Chat.tsx orchestrates all new components correctly
    - Build passes
  </done>
</task>

</tasks>

<verification>
- `pnpm --filter @tek/cli build` completes without errors
- Chat.tsx imports and renders WelcomeScreen, ToolPanel, and updated StatusBar
- WelcomeScreen shows agent name and help info
- StatusBar is borderless single-line with 3 zones
- Active tool calls render in live region with expand/collapse
</verification>

<success_criteria>
Empty chat displays a welcome screen with agent name, available commands, and keyboard shortcuts. StatusBar is a compact single-line display with connection status, model, and usage. Active tool calls are expandable in the live render region while completed ones remain as collapsed summaries in the Static message history.
</success_criteria>

<output>
After completion, create `.planning/phases/26-cli-visual-overhaul/26-04-SUMMARY.md`
</output>
